{"version":3,"file":"static/webpack/static/development/pages/settings/[key].js.081010925704eef1c8f8.hot-update.js","sources":["webpack:///./pages/settings/[key].tsx","webpack:///./reducers/fieldsReducer.tsx"],"sourcesContent":["import Header from \"../../components/Header\";\nimport { useRouter } from \"next/router\";\nimport { useState, useEffect, useContext, useReducer } from \"react\";\nimport axios from \"axios\";\nimport fieldsReducer from \"../../reducers/fieldsReducer\";\nimport UserContext from \"../../components/UserContext\";\nimport DefaultFieldsSection from \"../../components/settings/DefaultFieldsSection\";\nimport CustomFieldsSection from \"../../components/settings/customFields/CustomFieldsSection\";\nimport LoadingSpinner from \"../../components/LoadingSpinner\";\nimport EmailSettingsSection from \"../../components/settings/emailSettings/EmailSettingsSection\";\nimport WebFormSection from \"../../components/settings/webform/WebFormSection\";\nimport globalVars from \"../../library/globalVariables\";\nimport stringMethods from \"../../library/stringMethods\";\nimport Typography from \"@material-ui/core/Typography\";\n\nconst Settings = ({ dataFields, username, pass }: any) => {\n  const router = useRouter();\n  const [initialized, setInitialized] = useState(false);\n  const [sections, setSection] = useState({});\n  const user = useContext(UserContext);\n\n  const [state, dispatch] = useReducer(fieldsReducer, dataFields);\n\n  useEffect(() =>Â {\n    console.log(fields);\n  }, [fields])\n\n  const toggleSection = e => {\n    setSection({\n      ...sections,\n      [e.target.name]: e.target.checked\n    });\n  };\n\n  const addField = obj => {\n    setField({\n        type: \"addNewField\",\n        payload: { obj } \n    });\n  };\n\n  const deleteField = id => {\n    setField({\n      type: \"deleteField\",\n      payload: {id}\n    });\n  };\n\n  useEffect(() => {\n    //title from url\n    const title = new stringMethods(router.pathname)\n      .removeSlash()\n      .removeSlashAndTextAfter()\n      .firstCharUpperCase()\n      .addStringToEnd(globalVars.titleSubText)\n      .getString();\n    document.title = title;\n    //componendDidMount effect\n    setInitialized(true);\n    user.checkUser();\n  }, [router]);\n\n  const h1 = new stringMethods(router.pathname)\n    .removeSlash()\n    .removeSlashAndTextAfter()\n    .firstCharUpperCase()\n    .getString();\n\n  return !user.user.signedIn && !initialized ? (\n    <LoadingSpinner />\n  ) : (\n    <div>\n      <Header />\n      <Typography variant=\"h3\" component=\"h1\" gutterBottom>\n        {h1}\n      </Typography>\n      <DefaultFieldsSection\n        fields={fields}\n        toggleSection={toggleSection}\n        sections={sections}\n      />\n      <CustomFieldsSection\n        fields={fields}\n        deleteField={deleteField}\n        addField={addField}\n        sections={sections}\n        toggleSection={toggleSection}\n      />\n      <EmailSettingsSection\n        username={username}\n        pass={pass}\n        toggleSection={toggleSection}\n        sections={sections}\n      />\n      <WebFormSection\n        fields={fields}\n        toggleSection={toggleSection}\n        sections={sections}\n      />\n    </div>\n  );\n};\n\nSettings.getInitialProps = async (context: any) => {\n  const resFields = await axios({\n    method: \"GET\",\n    params: { key: context.query.key },\n    url: `${globalVars.serverURL}/fields`,\n    responseType: \"json\"\n  });\n  const dataFields = await resFields.data;\n\n  const resEmailSettings = await axios({\n    method: \"GET\",\n    params: { key: context.query.key },\n    url: `${globalVars.serverURL}/emails/email-settings`,\n    responseType: \"json\"\n  });\n\n  const dataEmailSettings = await resEmailSettings.data;\n  const { username, pass } = await dataEmailSettings;\n\n  return { dataFields, username, pass };\n};\n\nexport default Settings;\n","const fieldsReducer = (state, action) => {\n  switch (action.type) {\n    case \"addNewField\":\n      return state.some(field => field._id === action.payload.obj._id)\n        ? state.map(field =>\n            field._id === action.payload.obj._id ? action.payload.obj : field\n          )\n        : [...state, action.payload.obj];\n    case \"deleteField\":\n      return state.filter(field => field._id !== action.payload.id);\n    case \"addToWF\":\n      return state.map(field =>\n        field.fieldName === action.payload.fieldName\n          ? { ...field, fieldInForm: true, order: action.payload.counter }\n          : field\n      );\n    case \"addVisibleSelectWF\":\n      return state.map(field =>\n        field.pause\n          ? {\n              ...field,\n              fieldInForm: true,\n              fieldFormVisible: true,\n              pause: false,\n              order: action.payload.counter\n            }\n          : field\n      );\n    case \"addNotVisibleValue\":\n      return state.map(field =>\n        field.pause\n          ? {\n              ...field,\n              fieldFormVisible: false\n            }\n          : field\n      );\n    case \"addHiddenSelectWF\":\n      return state.map(field =>\n        field.pause\n          ? {\n              ...field,\n              fieldInForm: true,\n              pause: false,\n              order: action.payload.counter,\n              fieldOptions: field.fieldOptions.map(option =>\n                option.value === action.payload.optionValue\n                  ? { ...option, preselected: true }\n                  : option\n              )\n            }\n          : field\n      );\n    case \"pauseSelect\":\n      return state.map(field =>\n        field.fieldName === action.payload.fieldName\n          ? { ...field, pause: true }\n          : field\n      );\n\n    case \"removeFromWF\":\n      return state.map(field =>\n        field.fieldName === action.payload.fieldName\n          ? {\n              ...field,\n              fieldInForm: false,\n              fieldFormVisible: null,\n              fieldOptions: field.fieldOptions.map(option =>\n                option.preselected ? { ...option, preselected: null } : option\n              )\n            }\n          : field\n      );\n    default:\n      throw new Error();\n  }\n};\n\nexport default fieldsReducer;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAGA;AACA;AALA;AAAA;AAAA;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AAEA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAJA;AACA;AAFA;AACA;AADA;AAAA;AACA;AADA;AAOA;AAPA;AAAA;AAUA;AACA;AAAA;AAAA;AACA;AACA;AAJA;AACA;AAVA;AASA;AATA;AAAA;AACA;AADA;AAgBA;AAhBA;AAAA;AACA;AADA;AAAA;AAiBA;AAAA;AAjBA;AAmBA;AAAA;AAAA;AAAA;AACA;AApBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAqBA;;;;;;;;;;;;;;;;;;AC7HA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AADA;AADA;AACA;AAIA;AACA;AAAA;AAIA;AACA;AACA;AACA;AANA;AADA;AACA;AAUA;AACA;AAAA;AAIA;AAHA;AADA;AACA;AAOA;AACA;AAAA;AAIA;AACA;AACA;AACA;AAAA;AAEA;AADA;AADA;AANA;AADA;AACA;AAcA;AACA;AAAA;AAEA;AADA;AADA;AACA;AAKA;AACA;AAAA;AAIA;AACA;AACA;AAAA;AACA;AAAA;AADA;AALA;AADA;AACA;AAWA;AACA;AAzEA;AA2EA;AACA;AACA;;;;A","sourceRoot":""}