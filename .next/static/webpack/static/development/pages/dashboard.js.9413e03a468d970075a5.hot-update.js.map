{"version":3,"file":"static/webpack/static/development/pages/dashboard.js.9413e03a468d970075a5.hot-update.js","sources":["webpack:///./pages/dashboard.tsx"],"sourcesContent":["import Header from \"../components/Header\";\nimport { useEffect, useState, useContext } from \"react\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\nimport ShowRecordsNumber from \"../components/ShowRecordsNumber\";\nimport LoadingSpinner from \"../components/LoadingSpinner\";\nimport UserContext from \"../components/UserContext\";\nimport CountContext from \"../components/CountContext\";\nimport globalVars from \"../library/globalVariables\";\nimport stringMethods from \"../library/stringMethods\";\nimport languages from \"../library/languages\";\n\nconst Dashboard = ({lastCampaign, clientsLastWeek} : any) => {\n  const router = useRouter();\n  const [initialized, setInitialized] = useState(false);\n  const user = useContext(UserContext);\n\n  const { \n    emailsCounter,\n    clientCounter, \n    fieldCounter \n  } = useContext(CountContext);\n\n  useEffect(() => {\n    const title = new stringMethods(router.pathname)\n      .removeSlash()\n      .firstCharUpperCase()\n      .addStringToEnd(globalVars.titleSubText)\n      .getString();\n    document.title = title;\n    setInitialized(true);\n    user.checkUser();\n  }, [router]);\n\n  const h1 = new stringMethods(router.pathname)\n    .removeSlash()\n    .firstCharUpperCase()\n    .getString();\n\n  const campaignStr = lastCampaign.length > 0  ? `${languages.en.last} ${languages.en.sent} ${lastCampaign[0].date} ${languages.en.to.toLowerCase()} ${lastCampaign[0].to.length} ${lastCampaign[0].to.length > 1 ? languages.en.clients : languages.en.client}` : \"\"\n\n  const lastWeekStr = `${clientsLastWeek > 0 ? \"+\" : \"\"} ${clientsLastWeek} ${languages.en.lastWeek}`\n\n  return !initialized  && !user.user.signedIn ? (\n    <LoadingSpinner />\n  ) : (\n    <div>\n      <Header />\n      <h1>{h1}</h1>\n      <ShowRecordsNumber\n        data={clientCounter}\n        string={languages.en.clientsSaved}\n        buttonString={languages.en.clients}\n        subData={lastWeekStr}\n        link={\"/clients\"}\n      />\n      <ShowRecordsNumber\n        data={fieldCounter.custom}\n        string={languages.en.customClientFields}\n        buttonString={languages.en.customClientFields}\n        subData={`${fieldCounter.permanent + fieldCounter.custom} ${languages.en.total}`}\n        link={\"/settings\"}\n      />\n      <ShowRecordsNumber\n        data={emailsCounter}\n        string={languages.en.emailsSent}\n        buttonString={languages.en.emails}\n        subData={campaignStr}\n        link={\"/emails\"}\n      />\n    </div>\n  );\n};\n\nDashboard.getInitialProps = async (context: any) =>Â {\n  const resLastCampaign = await axios({\n    method: \"GET\",\n    params: {key: context.query.Api_KEY},\n    url: `${globalVars.serverURL}/emails/last`,\n    responseType: \"json\"\n  }) \n  const lastCampaign = await resLastCampaign.data;\n\n  const resLastWeekNumber = await axios({\n    method: \"GET\",\n    params: {key: context.query.Api_KEY},\n    url: `${globalVars.serverURL}/clients/last-week`,\n    responseType: \"json\"\n  })\n\n  const clientsLastWeek = await resLastWeekNumber.data;\n\n    const resClientCount = await axios({\n      method: \"GET\",\n      url: `${globalVars.serverURL}/clients/count`,\n      params: {key: context.query.Api_KEY},\n      responseType: \"json\"\n    });\n    const clientCounter = await resClientCount.data;\n\n    const resFieldsData = await axios({\n      method: \"GET\",\n      url: `${globalVars.serverURL}/fields/count`,\n      params: {key: context.query.Api_KEY},\n      responseType: \"json\"\n    });\n    const fieldCounter = await resFieldsData.data;\n\n    const resEmailsCount = await axios({\n      method: \"GET\",\n      url: `${globalVars.serverURL}/emails/count`,\n      params: {key: context.query.Api_KEY},\n      responseType: \"json\"\n    });\n    const emailsCounter = await resEmailsCount.data;\n\n  return {lastCampaign, clientsLastWeek, clientCounter, fieldCounter, emailsCounter};\n}\n\nexport default Dashboard;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AACA;AAEA;AACA;AAJA;AAAA;AAAA;AAAA;AACA;AAUA;AACA;AAKA;AACA;AACA;AACA;AAEA;AAKA;AAEA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AAJA;AACA;AAFA;AACA;AADA;AAAA;AACA;AADA;AAOA;AAPA;AAAA;AAUA;AACA;AAAA;AAAA;AACA;AACA;AAJA;AACA;AAVA;AASA;AATA;AAAA;AACA;AADA;AAgBA;AAhBA;AAAA;AAmBA;AACA;AACA;AAAA;AAAA;AACA;AAJA;AACA;AAnBA;AAkBA;AAlBA;AAAA;AACA;AADA;AAwBA;AAxBA;AAAA;AA2BA;AACA;AACA;AAAA;AAAA;AACA;AAJA;AACA;AA3BA;AA0BA;AA1BA;AAAA;AACA;AADA;AAgCA;AAhCA;AAAA;AAmCA;AACA;AACA;AAAA;AAAA;AACA;AAJA;AACA;AAnCA;AAkCA;AAlCA;AAAA;AACA;AADA;AAwCA;AAxCA;AA0CA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AA3CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AA4CA;;;;A","sourceRoot":""}