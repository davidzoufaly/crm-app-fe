{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/davidzoufaly/code/dp/crm-app-fe/pages/_app.tsx\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport App from \"next/app\";\nimport Head from \"next/head\";\nimport Router from \"next/router\";\nimport axios from \"axios\";\nimport CountContext from \"../components/CountContext\";\nimport UserContext from \"../components/UserContext\";\nimport globalVars from \"../library/globalVariables\";\nimport theme from \"../src/theme\";\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\n\nvar MyApp =\n/*#__PURE__*/\nfunction (_App) {\n  _inherits(MyApp, _App);\n\n  function MyApp() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MyApp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MyApp)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      counters: {\n        clientCounter: \"\",\n        emailsCounter: \"\",\n        fieldCounter: \"\"\n      },\n      user: {\n        username: \"\",\n        signedIn: false\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getCounts\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var resClientCount, clientCounter, resFieldsData, fieldCounter, resEmailsCount, emailsCounter;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return axios({\n                method: \"GET\",\n                url: \"\".concat(globalVars.serverURL, \"/clients/count\"),\n                responseType: \"json\"\n              });\n\n            case 2:\n              resClientCount = _context.sent;\n              _context.next = 5;\n              return resClientCount.data;\n\n            case 5:\n              clientCounter = _context.sent;\n              _context.next = 8;\n              return axios({\n                method: \"GET\",\n                url: \"\".concat(globalVars.serverURL, \"/fields/count\"),\n                responseType: \"json\"\n              });\n\n            case 8:\n              resFieldsData = _context.sent;\n              _context.next = 11;\n              return resFieldsData.data;\n\n            case 11:\n              fieldCounter = _context.sent;\n              _context.next = 14;\n              return axios({\n                method: \"GET\",\n                url: \"\".concat(globalVars.serverURL, \"/emails/count\"),\n                responseType: \"json\"\n              });\n\n            case 14:\n              resEmailsCount = _context.sent;\n              _context.next = 17;\n              return resEmailsCount.data;\n\n            case 17:\n              emailsCounter = _context.sent;\n\n              _this.setState({\n                clientCounter: clientCounter,\n                fieldCounter: fieldCounter,\n                emailsCounter: emailsCounter\n              });\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"setUser\", function (username) {\n      _this.setState(_objectSpread({}, _this.state, {\n        user: _objectSpread({}, _this.state.user, {\n          username: username,\n          signedIn: true\n        })\n      }));\n\n      sessionStorage.setItem('user', _this.state.user.username);\n      sessionStorage.setItem('signedIn', _this.state.user.signedIn.toString());\n      Router.push('/dashboard');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkUser\", function () {\n      sessionStorage.getItem('signedIn') === \"false\" ? Router.push('/') : _this.setState(_objectSpread({}, _this.state, {\n        user: _objectSpread({}, _this.state.user, {\n          username: sessionStorage.getItem('user'),\n          signedIn: true\n        })\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"logoutUser\", function () {\n      _this.setState(_objectSpread({}, _this.state, {\n        user: _objectSpread({}, _this.state.user, {\n          username: \"\",\n          signedIn: false\n        })\n      }), function () {\n        sessionStorage.setItem('user', _this.state.user.username);\n        sessionStorage.setItem('signedIn', _this.state.user.signedIn.toString());\n      });\n\n      Router.push('/');\n    });\n\n    return _this;\n  }\n\n  _createClass(MyApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var jssStyles = document.querySelector(\"#jss-server-side\");\n\n      if (jssStyles) {\n        jssStyles.parentNode.removeChild(jssStyles);\n      }\n\n      console.log(this.state.user);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      console.log(this.state.user);\n      this.getCounts();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps;\n      return __jsx(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, __jsx(Head, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, __jsx(\"title\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, \"CRM APP\")), __jsx(UserContext.Provider, {\n        value: {\n          setUser: this.setUser,\n          logoutUser: this.logoutUser,\n          checkUser: this.checkUser,\n          user: this.state.user\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, __jsx(CountContext.Provider, {\n        value: this.state.counters,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, __jsx(ThemeProvider, {\n        theme: theme,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, __jsx(CssBaseline, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }), __jsx(Component, _extends({}, pageProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }))))));\n    }\n  }]);\n\n  return MyApp;\n}(App);\n\nexport { MyApp as default };","map":{"version":3,"sources":["/Users/davidzoufaly/code/dp/crm-app-fe/pages/_app.tsx"],"names":["React","App","Head","Router","axios","CountContext","UserContext","globalVars","theme","ThemeProvider","CssBaseline","MyApp","counters","clientCounter","emailsCounter","fieldCounter","user","username","signedIn","method","url","serverURL","responseType","resClientCount","data","resFieldsData","resEmailsCount","setState","state","sessionStorage","setItem","toString","push","getItem","jssStyles","document","querySelector","parentNode","removeChild","console","log","getCounts","props","Component","pageProps","setUser","logoutUser","checkUser"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport App from \"next/app\";\nimport Head from \"next/head\";\nimport Router from \"next/router\";\nimport axios from \"axios\";\nimport CountContext from \"../components/CountContext\";\nimport UserContext from \"../components/UserContext\";\nimport globalVars from \"../library/globalVariables\";\nimport theme from \"../src/theme\";\nimport { ThemeProvider } from \"@material-ui/styles\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\n\nexport default class MyApp extends App {\n  state = {\n    counters: { clientCounter: \"\", emailsCounter: \"\", fieldCounter: \"\" },\n    user: {\n      username: \"\",\n      signedIn: false\n    }\n  };\n\n  componentDidMount() {\n    const jssStyles = document.querySelector(\"#jss-server-side\");\n    if (jssStyles) {\n      jssStyles.parentNode.removeChild(jssStyles);\n    }\n    console.log(this.state.user);\n  }\n\n  getCounts = async () => {\n    const resClientCount = await axios({\n      method: \"GET\",\n      url: `${globalVars.serverURL}/clients/count`,\n      responseType: \"json\"\n    });\n    const clientCounter = await resClientCount.data;\n\n    const resFieldsData = await axios({\n      method: \"GET\",\n      url: `${globalVars.serverURL}/fields/count`,\n      responseType: \"json\"\n    });\n    const fieldCounter = await resFieldsData.data;\n\n    const resEmailsCount = await axios({\n      method: \"GET\",\n      url: `${globalVars.serverURL}/emails/count`,\n      responseType: \"json\"\n    });\n    const emailsCounter = await resEmailsCount.data;\n\n    this.setState({\n      clientCounter,\n      fieldCounter,\n      emailsCounter\n    });\n  };\n\n  setUser = username => {\n    this.setState({\n      ...this.state,\n      user: {...this.state.user, username, signedIn: true}\n    });\n    sessionStorage.setItem('user', this.state.user.username);\n    sessionStorage.setItem('signedIn', this.state.user.signedIn.toString());\n    Router.push('/dashboard');\n  };\n\n  checkUser = () =>Â {\n    sessionStorage.getItem('signedIn') === \"false\"\n      ? Router.push('/')\n      : this.setState({\n        ...this.state,\n        user: {...this.state.user, \n            username : sessionStorage.getItem('user'), \n            signedIn: true\n          }\n      });\n  }\n\n  logoutUser = () => {\n    this.setState({\n      ...this.state,\n      user: {...this.state.user, username : \"\", signedIn: false}\n    }, () => {\n      sessionStorage.setItem('user', this.state.user.username)\n      sessionStorage.setItem('signedIn', this.state.user.signedIn.toString())\n    })\n    Router.push('/');\n  }\n\n  componentDidUpdate() {\n    console.log(this.state.user);\n    this.getCounts();\n  }\n\n  render() {\n    const { Component, pageProps } = this.props;\n\n    return (\n      <React.Fragment>\n        <Head>\n          <title>CRM APP</title>\n        </Head>\n        <UserContext.Provider\n          value={{ setUser: this.setUser, logoutUser: this.logoutUser, checkUser: this.checkUser, user: this.state.user }}\n        >\n          <CountContext.Provider value={this.state.counters}>\n            <ThemeProvider theme={theme}>\n              <CssBaseline />\n              <Component {...pageProps} />\n            </ThemeProvider>\n          </CountContext.Provider>\n        </UserContext.Provider>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}