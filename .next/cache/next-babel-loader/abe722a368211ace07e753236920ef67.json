{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/davidzoufaly/code/dp/crm-app-fe/components/CustomFields.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useReducer, useEffect } from \"react\";\nimport AddOrEditField from \"./AddOrEditField\";\nimport axios from \"axios\";\nimport globalVars from \"../library/globalVariables\";\nimport uniqid from \"uniqid\";\nimport CustomFieldsList from \"./CustomFieldsList\";\nimport Typography from \"@material-ui/core/Typography\";\nimport SelectFieldOptions from \"./SelectFieldOptions\"; //TODO: EDIT OPTIONU SE PRERENDEROVAVA -> TO much baskspace u optionu uplne odstraní pole\n\nconst CustomClientFields = ({\n  fields,\n  refreshList\n}) => {\n  const blankFieldObject = {\n    fieldName: \"\",\n    fieldType: \"text\",\n    fieldOptions: []\n  };\n  useEffect(() => {// console.log(editedField);\n  });\n  const {\n    0: displayComponent,\n    1: setDisplayComponent\n  } = useState(false);\n  const {\n    0: editedField,\n    1: setEditedField\n  } = useReducer((state, action) => {\n    switch (action.type) {\n      case \"fieldNameChange\":\n        return _objectSpread({}, state, {\n          fieldName: action.payload.value\n        });\n\n      case \"selectValueChange\":\n        return _objectSpread({}, state, {\n          fieldType: action.payload.options[action.payload.options.selectedIndex].value\n        });\n\n      case \"newOptionSpawn\":\n        return _objectSpread({}, state, {\n          fieldOptions: [...state.fieldOptions, {\n            id: action.payload.id\n          }]\n        });\n\n      case \"clear\":\n        return blankFieldObject;\n\n      case \"optionValueChange\":\n        return _objectSpread({}, state, {\n          fieldOptions: state.fieldOptions.filter(el => action.payload.id === el.id ? el.value = action.payload.value : el)\n        });\n\n      case \"optionDelete\":\n        return _objectSpread({}, state, {\n          fieldOptions: state.fieldOptions.filter(e => action.payload.id !== e.id)\n        });\n\n      case \"setWithPaylod\":\n        return action.payload.obj;\n\n      default:\n        return state;\n    }\n  }, blankFieldObject);\n  const fieldMethods = {\n    onNameChange(event) {\n      setEditedField({\n        type: \"fieldNameChange\",\n        payload: {\n          value: event.target.value\n        }\n      });\n    },\n\n    onSelectChange(event) {\n      setEditedField({\n        type: \"selectValueChange\",\n        payload: {\n          options: event.target.options\n        }\n      });\n    },\n\n    handleOptionSpawn(e) {\n      e.preventDefault();\n      setEditedField({\n        type: \"newOptionSpawn\",\n        payload: {\n          id: uniqid()\n        }\n      });\n    },\n\n    toggleDisplayComponent() {\n      displayComponent ? setDisplayComponent(false) : setDisplayComponent(true);\n      setEditedField({\n        type: \"clear\"\n      });\n    },\n\n    onOptionDelete(event) {\n      setEditedField({\n        type: \"optionDelete\",\n        payload: {\n          id: event.target.id\n        }\n      });\n    },\n\n    onOptionChange(id, event) {\n      setEditedField({\n        type: \"optionValueChange\",\n        payload: {\n          value: event.target.value,\n          id\n        }\n      });\n    },\n\n    setupEditedField(obj) {\n      setEditedField({\n        type: \"setWithPaylod\",\n        payload: {\n          obj\n        }\n      });\n      !displayComponent ? setDisplayComponent(true) : null;\n    },\n\n    saveEditedField(e) {\n      e.preventDefault();\n\n      const fieldIsUpdated = async () => {\n        const {\n          fieldName,\n          fieldType,\n          fieldOptions,\n          id\n        } = editedField;\n        const res = await axios({\n          method: \"put\",\n          url: `${globalVars.serverURL}/fields/${id}`,\n          data: {\n            fieldName,\n            fieldType,\n            fieldOptions\n          },\n          responseType: \"json\"\n        });\n        const data = await res.data;\n\n        if (data.msg === \"Success\") {\n          reset();\n        }\n      };\n\n      const fieldIsCreated = async () => {\n        const res = await axios({\n          method: \"post\",\n          url: `${globalVars.serverURL}/fields/`,\n          data: editedField,\n          responseType: \"json\"\n        });\n        const data = await res.data;\n\n        if (data.msg === \"Success\") {\n          reset();\n        }\n      };\n\n      !editedField.id ? fieldIsCreated() : fieldIsUpdated();\n    }\n\n  };\n\n  const reset = () => {\n    setDisplayComponent(false);\n    setEditedField({\n      type: \"clear\"\n    });\n    refreshList();\n  };\n\n  const deleteField = async id => {\n    const res = await axios({\n      method: \"delete\",\n      url: `${globalVars.serverURL}/fields/${id}`,\n      responseType: \"json\"\n    });\n    const resData = await res.data;\n    resData.msg === \"Success\" ? refreshList() : null;\n  };\n\n  return __jsx(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, __jsx(Typography, {\n    variant: \"h4\",\n    component: \"h2\",\n    gutterBottom: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, \"Custom Client Fields\"), __jsx(CustomFieldsList, {\n    deleteField: deleteField,\n    fields: fields,\n    setupEditedField: fieldMethods.setupEditedField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }), __jsx(AddOrEditField, {\n    editedField: editedField,\n    displayComponent: displayComponent,\n    fieldMethods: fieldMethods,\n    handleOption: __jsx(SelectFieldOptions, {\n      editedField: editedField,\n      fieldMethods: fieldMethods,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }));\n};\n\nexport default CustomClientFields;","map":{"version":3,"sources":["/Users/davidzoufaly/code/dp/crm-app-fe/components/CustomFields.tsx"],"names":["useState","useReducer","useEffect","AddOrEditField","axios","globalVars","uniqid","CustomFieldsList","Typography","SelectFieldOptions","CustomClientFields","fields","refreshList","blankFieldObject","fieldName","fieldType","fieldOptions","displayComponent","setDisplayComponent","editedField","setEditedField","state","action","type","payload","value","options","selectedIndex","id","filter","el","e","obj","fieldMethods","onNameChange","event","target","onSelectChange","handleOptionSpawn","preventDefault","toggleDisplayComponent","onOptionDelete","onOptionChange","setupEditedField","saveEditedField","fieldIsUpdated","res","method","url","serverURL","data","responseType","msg","reset","fieldIsCreated","deleteField","resData"],"mappings":"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","sourcesContent":["import { useState, useReducer, useEffect } from \"react\";\nimport AddOrEditField from \"./AddOrEditField\";\nimport axios from \"axios\";\nimport globalVars from \"../library/globalVariables\";\nimport uniqid from \"uniqid\";\nimport CustomFieldsList from \"./CustomFieldsList\";\nimport Typography from \"@material-ui/core/Typography\";\nimport SelectFieldOptions from \"./SelectFieldOptions\";\n\n//TODO: EDIT OPTIONU SE PRERENDEROVAVA -> TO much baskspace u optionu uplne odstraní pole\n\nconst CustomClientFields = ({ fields, refreshList }: any) => {\n  const blankFieldObject = {\n    fieldName: \"\",\n    fieldType: \"text\",\n    fieldOptions: []\n  };\n\n  useEffect(() => {\n    // console.log(editedField);\n  });\n\n  const [displayComponent, setDisplayComponent] = useState(false);\n\n  const [editedField, setEditedField] = useReducer((state, action) => {\n    switch (action.type) {\n      case \"fieldNameChange\":\n        return {\n          ...state,\n          fieldName: action.payload.value\n        };\n      case \"selectValueChange\":\n        return {\n          ...state,\n          fieldType:\n            action.payload.options[action.payload.options.selectedIndex].value\n        };\n      case \"newOptionSpawn\":\n        return {\n          ...state,\n          fieldOptions: [...state.fieldOptions, { id: action.payload.id }]\n        };\n      case \"clear\":\n        return blankFieldObject;\n      case \"optionValueChange\":\n        return {\n          ...state,\n          fieldOptions: state.fieldOptions.filter((el: any) =>\n            action.payload.id === el.id\n              ? (el.value = action.payload.value)\n              : el\n          )\n        };\n      case \"optionDelete\":\n        return {\n          ...state,\n          fieldOptions: state.fieldOptions.filter(\n            (e: any) => action.payload.id !== e.id\n          )\n        };\n      case \"setWithPaylod\":\n        return action.payload.obj;\n\n      default:\n        return state;\n    }\n  }, blankFieldObject);\n\n  const fieldMethods = {\n    onNameChange(event: any) {\n      setEditedField({\n        type: \"fieldNameChange\",\n        payload: { value: event.target.value }\n      });\n    },\n    onSelectChange(event: any) {\n      setEditedField({\n        type: \"selectValueChange\",\n        payload: { options: event.target.options }\n      });\n    },\n    handleOptionSpawn(e) {\n      e.preventDefault()\n      setEditedField({\n        type: \"newOptionSpawn\",\n        payload: {id: uniqid()}\n      });\n    },\n    toggleDisplayComponent() {\n      displayComponent ? setDisplayComponent(false) : setDisplayComponent(true);\n      setEditedField({ type: \"clear\" });\n    },\n    onOptionDelete(event: any) {\n      setEditedField({\n        type: \"optionDelete\",\n        payload: { id: event.target.id }\n      });\n    },\n    onOptionChange(id, event) {\n      setEditedField({\n        type: \"optionValueChange\",\n        payload: { value: event.target.value, id }\n      });\n    },\n    setupEditedField(obj: any) {\n      setEditedField({\n        type: \"setWithPaylod\",\n        payload: { obj }\n      });\n      !displayComponent ? setDisplayComponent(true) : null;\n    },\n    saveEditedField(e) {\n      e.preventDefault();\n\n      const fieldIsUpdated = async () => {\n        const { fieldName, fieldType, fieldOptions, id } = editedField;\n        const res = await axios({\n          method: \"put\",\n          url: `${globalVars.serverURL}/fields/${id}`,\n          data: { fieldName, fieldType, fieldOptions },\n          responseType: \"json\"\n        });\n        const data = await res.data;\n        if (data.msg === \"Success\") {\n          reset();\n        }\n      };\n\n      const fieldIsCreated = async () => {\n        const res = await axios({\n          method: \"post\",\n          url: `${globalVars.serverURL}/fields/`,\n          data: editedField,\n          responseType: \"json\"\n        });\n        const data = await res.data;\n        if (data.msg === \"Success\") {\n          reset();\n        }\n      };\n      !editedField.id ? fieldIsCreated() : fieldIsUpdated();\n    }\n  };\n\n  const reset = () => {\n    setDisplayComponent(false);\n    setEditedField({ type: \"clear\" });\n    refreshList();\n  };\n\n  const deleteField = async (id: any) => {\n    const res = await axios({\n      method: \"delete\",\n      url: `${globalVars.serverURL}/fields/${id}`,\n      responseType: \"json\"\n    });\n    const resData = await res.data;\n    resData.msg === \"Success\" ? refreshList() : null;\n  };\n\n\n  return (\n    <div>\n      <Typography variant=\"h4\" component=\"h2\" gutterBottom>\n        Custom Client Fields\n      </Typography>\n      <CustomFieldsList\n        deleteField={deleteField}\n        fields={fields}\n        setupEditedField={fieldMethods.setupEditedField}\n      />\n      <AddOrEditField\n        editedField={editedField}\n        displayComponent={displayComponent}\n        fieldMethods={fieldMethods}\n        handleOption={\n          <SelectFieldOptions\n            editedField={editedField}\n            fieldMethods={fieldMethods}\n          />\n        }\n      />\n    </div>\n  );\n};\n\nexport default CustomClientFields;\n"]},"metadata":{},"sourceType":"module"}