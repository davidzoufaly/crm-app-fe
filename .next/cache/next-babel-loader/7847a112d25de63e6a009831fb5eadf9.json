{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState, useContext } from \"react\";\nimport { useRouter } from \"next/router\";\nimport axios from \"axios\";\nimport Header from \"../../components/Header\";\nimport ShowRecordsNumber from \"../../components/dashboard/ShowRecordsNumber\";\nimport LoadingSpinner from \"../../components/LoadingSpinner\";\nimport UserContext from \"../../components/UserContext\";\nimport globalVars from \"../../library/globalVariables\";\nimport stringMethods from \"../../library/stringMethods\";\nimport languages from \"../../library/languages\";\nimport { Typography, Grid } from \"@material-ui/core\";\n\nvar Dashboard = function Dashboard(_ref) {\n  var lastCampaign = _ref.lastCampaign,\n      clientsLastWeek = _ref.clientsLastWeek,\n      clientCounter = _ref.clientCounter,\n      fieldCounter = _ref.fieldCounter,\n      emailsCounter = _ref.emailsCounter;\n  var router = useRouter();\n\n  var _useState = useState(false),\n      initialized = _useState[0],\n      setInitialized = _useState[1];\n\n  var user = useContext(UserContext);\n  useEffect(function () {\n    var title = new stringMethods(router.pathname).removeSlash().removeSlashAndTextAfter().firstCharUpperCase().addStringToEnd(globalVars.titleSubText).getString();\n    document.title = title;\n    setInitialized(true);\n    user.checkUser();\n  }, [router]);\n  var h1 = new stringMethods(router.pathname).removeSlash().removeSlashAndTextAfter().firstCharUpperCase().getString();\n  var campaignStr = lastCampaign.length > 0 ? \"\".concat(languages.en.last, \" \").concat(languages.en.sent, \" \").concat(lastCampaign[0].date, \" \").concat(languages.en.to.toLowerCase(), \" \").concat(lastCampaign[0].to.length, \" \").concat(lastCampaign[0].to.length > 1 ? languages.en.clients : languages.en.client) : \"\";\n  var lastWeekStr = \"\".concat(clientsLastWeek > 0 ? \"+\" : \"\", \" \").concat(clientsLastWeek, \" \").concat(languages.en.pastSevenDays);\n  return !initialized && !user.user.signedIn ? __jsx(LoadingSpinner, null) : __jsx(React.Fragment, null, __jsx(Header, null), __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h3\",\n    gutterBottom: true\n  }, h1), __jsx(Grid, {\n    container: true,\n    justify: \"space-around\",\n    alignItems: \"stretch\",\n    spacing: 4\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 4\n  }, __jsx(ShowRecordsNumber, {\n    data: clientCounter,\n    string: languages.en.clientsSaved,\n    buttonString: languages.en.clients,\n    subData: lastWeekStr,\n    link: \"/clients\"\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 4\n  }, __jsx(ShowRecordsNumber, {\n    data: fieldCounter.custom,\n    string: languages.en.customClientFields,\n    buttonString: languages.en.customClientFields,\n    subData: \"\".concat(fieldCounter.permanent + fieldCounter.custom, \" \").concat(languages.en.total),\n    link: \"/settings\"\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 4\n  }, __jsx(ShowRecordsNumber, {\n    data: emailsCounter,\n    string: languages.en.emailsSent,\n    buttonString: languages.en.emails,\n    subData: campaignStr,\n    link: \"/emails\"\n  }))));\n};\n\nDashboard.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(context) {\n    var resLastCampaign, resLastWeekNumber, resClientCount, resFieldsData, resEmailsCount, lastCampaign, clientsLastWeek, clientCounter, fieldCounter, emailsCounter;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return axios(\"\".concat(globalVars.serverURL, \"/emails/last?key=\").concat(context.query.key));\n\n          case 2:\n            resLastCampaign = _context.sent;\n            _context.next = 5;\n            return axios(\"\".concat(globalVars.serverURL, \"/clients/last-week?key=\").concat(context.query.key));\n\n          case 5:\n            resLastWeekNumber = _context.sent;\n            _context.next = 8;\n            return axios(\"\".concat(globalVars.serverURL, \"/clients/count?key=\").concat(context.query.key));\n\n          case 8:\n            resClientCount = _context.sent;\n            _context.next = 11;\n            return axios(\"\".concat(globalVars.serverURL, \"/fields/count?key=\").concat(context.query.key));\n\n          case 11:\n            resFieldsData = _context.sent;\n            _context.next = 14;\n            return axios(\"\".concat(globalVars.serverURL, \"/emails/count?key=\").concat(context.query.key));\n\n          case 14:\n            resEmailsCount = _context.sent;\n            _context.next = 17;\n            return resLastCampaign.data;\n\n          case 17:\n            lastCampaign = _context.sent;\n            _context.next = 20;\n            return resLastWeekNumber.data;\n\n          case 20:\n            clientsLastWeek = _context.sent;\n            _context.next = 23;\n            return resClientCount.data;\n\n          case 23:\n            clientCounter = _context.sent;\n            _context.next = 26;\n            return resFieldsData.data;\n\n          case 26:\n            fieldCounter = _context.sent;\n            _context.next = 29;\n            return resEmailsCount.data;\n\n          case 29:\n            emailsCounter = _context.sent;\n            return _context.abrupt(\"return\", {\n              lastCampaign: lastCampaign,\n              clientsLastWeek: clientsLastWeek,\n              clientCounter: clientCounter,\n              fieldCounter: fieldCounter,\n              emailsCounter: emailsCounter\n            });\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport default Dashboard;","map":null,"metadata":{},"sourceType":"module"}